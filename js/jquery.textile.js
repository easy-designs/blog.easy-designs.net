(function(){jQuery.textile=function(m){var a=m,h,k,l,j,n,o,g,c,f;qtags=[["\\*","strong"],["\\?\\?","cite"],["\\+","ins"],["~","sub"],["\\^","sup"],["@","code"]];for(var e=0,b=qtags.length;e<b;e++){h=qtags[e][0];k=qtags[e][1];l=new RegExp(h+"\\b(.+?)\\b"+h,"g");a=a.replace(l,"<"+k+">$1</"+k+">")}l=new RegExp("\\b_(.+?)_\\b","g");a=a.replace(l,"<em>$1</em>");l=new RegExp("[s\n]-(.+?)-[s\n]","g");a=a.replace(l,"<del>$1</del>");l=new RegExp('"\\b(.+?)\\(\\b(.+?)\\b\\)":([^\\s]+)',"g");a=a.replace(l,'<a href="$3" title="$2">$1</a>');l=new RegExp('"\\b(.+?)\\b":([^\\s]+)',"g");a=a.replace(l,'<a href="$2">$1</a>');l=new RegExp("!\\b(.+?)\\(\\b(.+?)\\b\\)!","g");a=a.replace(l,'<img src="$1" alt="$2">');l=new RegExp("!\\b(.+?)\\b!","g");a=a.replace(l,'<img src="$1">');l=new RegExp("(.*)\n([^#*\n].*)","g");a=a.replace(l,"$1<br />$2");l=new RegExp("\n<br />","g");a=a.replace(l,"\n");n=a.split("\n");j="";for(var e=0,d=n.length;e<d;e++){o=n[e].replace(/\s*$/,"");g=0;if(o.search(/^\s*bq\.\s+/)!=-1){o=o.replace(/^\s*bq\.\s+/,"\t<blockquote>")+"</blockquote>";g=1}if(o.search(/^\s*h[1|2|3|4|5|6]\.\s+/)!=-1){l=new RegExp("h([1|2|3|4|5|6]).(.+)","g");o=o.replace(l,"<h$1>$2</h$1>");g=1}if(o.search(/^\s*\*\s+/)!=-1){o=o.replace(/^\s*\*\s+/,"\t<liu>")+"</liu>";g=1}if(o.search(/^\s*#\s+/)!=-1){o=o.replace(/^\s*#\s+/,"\t<lio>")+"</lio>";g=1}if(!g&&o.replace(/\s/g,"").length>0){o="<p>"+o+"</p>"}n[e]=o+"\n"}c=0;f="";for(var e=0,d=n.length;e<d;e++){o=n[e];if(c&&f=="ul"&&!o.match(/^\t<liu/)){o="</ul>\n"+o;c=0}if(c&&f=="ol"&&!o.match(/^\t<lio/)){o="</ol>\n"+o;c=0}if(!c&&o.match(/^\t<liu/)){o="<ul>"+o;c=1;f="ul"}if(!c&&o.match(/^\t<lio/)){o="<ol>"+o;c=1;f="ol"}n[e]=o}a=n.join("\n");a=a.replace(/li[o|u]>/g,"li>");return a}})();